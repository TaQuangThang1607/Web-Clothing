{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///D:/react%2Bspring/my-app/app/services/productService.ts"],"sourcesContent":["import { Product } from \"../types/product\"\r\nimport { ProductDTO } from \"../types/ProductDTO\"\r\n\r\n\r\nconst API_URL = 'http://localhost:8080/admin/products'\r\n//handle get all product\r\nexport async function getAllProducts(page: number = 0, size: number = 10): Promise<{\r\n    products: Product[];\r\n    currentPage: number;\r\n    totalItems: number;\r\n    totalPages: number;\r\n}> {\r\n    const res = await fetch(`${API_URL}?page=${page}&size=${size}`, {\r\n        method: 'GET',\r\n        next: { revalidate: 0 },\r\n    });\r\n\r\n    if (!res.ok) {\r\n        throw new Error('Lỗi khi lấy danh sách sản phẩm');\r\n    }\r\n\r\n    return res.json();\r\n}\r\n\r\n//handle create product(productService.ts)\r\nexport async function createProduct(formData: FormData): Promise<Product> {\r\n    const res = await fetch(API_URL, {\r\n        method: 'POST',\r\n        body: formData,\r\n        next: { revalidate: 0 },\r\n    });\r\n\r\n    if (!res.ok) {\r\n        const errorData = await res.json();\r\n        throw new Error(errorData.message || 'Lỗi khi tạo sản phẩm');\r\n    }\r\n\r\n    return res.json();\r\n}\r\n// productService.ts\r\nexport async function getProductById(id: number): Promise<Product> {\r\n  const res = await fetch(`${API_URL}/${id}`, {\r\n    method: 'GET',\r\n    next: { revalidate: 0 },\r\n  });\r\n\r\n  if (!res.ok) {\r\n    throw new Error(`Lỗi khi lấy thông tin sản phẩm: ${res.statusText}`);\r\n  }\r\n\r\n  return res.json();\r\n}\r\n\r\nexport async function updateProduct(id: number, formData: FormData): Promise<Product> {\r\n  const res = await fetch(`${API_URL}/${id}`, {\r\n    method: 'PATCH',\r\n    body: formData,\r\n    next: { revalidate: 0 },\r\n  });\r\n\r\n  if (!res.ok) {\r\n    const errorData = await res.json();\r\n    if (errorData.errors) {\r\n      const errorMessages = errorData.errors.map((err: any) => `${err.field}: ${err.message}`).join(', ');\r\n      throw new Error(errorMessages);\r\n    }\r\n    throw new Error(errorData.message || 'Lỗi khi cập nhật sản phẩm');\r\n  }\r\n\r\n  return res.json();\r\n}"],"names":[],"mappings":";;;;;;AAIA,MAAM,UAAU;AAET,eAAe,eAAe,OAAe,CAAC,EAAE,OAAe,EAAE;IAMpE,MAAM,MAAM,MAAM,MAAM,GAAG,QAAQ,MAAM,EAAE,KAAK,MAAM,EAAE,MAAM,EAAE;QAC5D,QAAQ;QACR,MAAM;YAAE,YAAY;QAAE;IAC1B;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACT,MAAM,IAAI,MAAM;IACpB;IAEA,OAAO,IAAI,IAAI;AACnB;AAGO,eAAe,cAAc,QAAkB;IAClD,MAAM,MAAM,MAAM,MAAM,SAAS;QAC7B,QAAQ;QACR,MAAM;QACN,MAAM;YAAE,YAAY;QAAE;IAC1B;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACT,MAAM,YAAY,MAAM,IAAI,IAAI;QAChC,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI;IACzC;IAEA,OAAO,IAAI,IAAI;AACnB;AAEO,eAAe,eAAe,EAAU;IAC7C,MAAM,MAAM,MAAM,MAAM,GAAG,QAAQ,CAAC,EAAE,IAAI,EAAE;QAC1C,QAAQ;QACR,MAAM;YAAE,YAAY;QAAE;IACxB;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,IAAI,MAAM,CAAC,gCAAgC,EAAE,IAAI,UAAU,EAAE;IACrE;IAEA,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,cAAc,EAAU,EAAE,QAAkB;IAChE,MAAM,MAAM,MAAM,MAAM,GAAG,QAAQ,CAAC,EAAE,IAAI,EAAE;QAC1C,QAAQ;QACR,MAAM;QACN,MAAM;YAAE,YAAY;QAAE;IACxB;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,YAAY,MAAM,IAAI,IAAI;QAChC,IAAI,UAAU,MAAM,EAAE;YACpB,MAAM,gBAAgB,UAAU,MAAM,CAAC,GAAG,CAAC,CAAC,MAAa,GAAG,IAAI,KAAK,CAAC,EAAE,EAAE,IAAI,OAAO,EAAE,EAAE,IAAI,CAAC;YAC9F,MAAM,IAAI,MAAM;QAClB;QACA,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI;IACvC;IAEA,OAAO,IAAI,IAAI;AACjB","debugId":null}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///D:/react%2Bspring/my-app/app/admin/products/create/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { createProduct } from \"@/app/services/productService\";\r\nimport { ProductDTO } from \"@/app/types/ProductDTO\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport React, { useState } from \"react\";\r\n\r\nexport default function CreateProductPage() {\r\n    const [formData, setFormData] = useState<ProductDTO>({\r\n        name: '',\r\n        description: '',\r\n        size: '',\r\n        color: '',\r\n        price: 0,\r\n        imageUrl: '', // Giữ lại để lưu URL từ backend sau khi upload\r\n    });\r\n    const [imagePreview, setImagePreview] = useState<string | null>(null); // State để lưu URL preview hình ảnh\r\n    const [imageFile, setImageFile] = useState<File | null>(null); // State để lưu file hình ảnh\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [success, setSuccess] = useState<string | null>(null);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    // Xử lý thay đổi input text\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n        const { name, value } = e.target;\r\n        setFormData((prev) => ({\r\n            ...prev,\r\n            [name]: name === 'price' ? parseFloat(value) : value,\r\n        }));\r\n    };\r\n\r\n    // Xử lý chọn file hình ảnh\r\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) {\r\n            setImageFile(file);\r\n            setImagePreview(URL.createObjectURL(file)); // Tạo URL tạm để preview\r\n        } else {\r\n            setImageFile(null);\r\n            setImagePreview(null);\r\n        }\r\n    };\r\n\r\n    // Xử lý submit form\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        const router = useRouter();\r\n        e.preventDefault();\r\n        setIsLoading(true);\r\n        try {\r\n            const data = new FormData();\r\n\r\n            // Tạo 1 blob JSON từ DTO\r\n            const jsonBlob = new Blob(\r\n                [JSON.stringify({\r\n                    name: formData.name,\r\n                    description: formData.description,\r\n                    size: formData.size,\r\n                    color: formData.color,\r\n                    price: formData.price\r\n                })],\r\n                { type: 'application/json' }\r\n            );\r\n\r\n            // Gắn DTO vào dưới tên dto để match với @RequestPart(\"product\")\r\n            data.append('product', jsonBlob);\r\n\r\n            // Gắn ảnh\r\n            if (imageFile) {\r\n                data.append('image', imageFile);\r\n            }\r\n\r\n            await createProduct(data);\r\n            setSuccess('Tạo sản phẩm thành công');\r\n            setFormData({ name: '', description: '', size: '', color: '', price: 0, imageUrl: '' });\r\n            setImageFile(null);\r\n            setImagePreview(null);\r\n            setError(null);\r\n            router.push('/admin/product');\r\n        } catch (error) {\r\n            setError('Lỗi khi tạo sản phẩm. Vui lòng kiểm tra lại.');\r\n            setSuccess(null);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n\r\n    return (\r\n        <div className=\"container mx-auto p-4\">\r\n            <h1 className=\"text-2xl font-bold mb-4\">Tạo Sản Phẩm</h1>\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                <div>\r\n                    <label htmlFor=\"name\" className=\"block\">Tên sản phẩm</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"name\"\r\n                        name=\"name\"\r\n                        value={formData.name}\r\n                        onChange={handleChange}\r\n                        className=\"w-full border p-2\"\r\n                        required\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label htmlFor=\"description\" className=\"block\">Mô tả</label>\r\n                    <textarea\r\n                        id=\"description\"\r\n                        name=\"description\"\r\n                        value={formData.description}\r\n                        onChange={handleChange}\r\n                        className=\"w-full border p-2\"\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label htmlFor=\"size\" className=\"block\">Kích thước</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"size\"\r\n                        name=\"size\"\r\n                        value={formData.size}\r\n                        onChange={handleChange}\r\n                        className=\"w-full border p-2\"\r\n                        required\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label htmlFor=\"color\" className=\"block\">Màu sắc</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"color\"\r\n                        name=\"color\"\r\n                        value={formData.color}\r\n                        onChange={handleChange}\r\n                        className=\"w-full border p-2\"\r\n                        required\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label htmlFor=\"price\" className=\"block\">Giá</label>\r\n                    <input\r\n                        type=\"number\"\r\n                        id=\"price\"\r\n                        name=\"price\"\r\n                        value={formData.price}\r\n                        onChange={handleChange}\r\n                        className=\"w-full border p-2\"\r\n                        required\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label htmlFor=\"image\" className=\"block\">Hình ảnh</label>\r\n                    <input\r\n                        type=\"file\"\r\n                        id=\"image\"\r\n                        name=\"image\"\r\n                        accept=\"image/*\"\r\n                        onChange={handleImageChange}\r\n                        className=\"w-full border p-2\"\r\n                        required\r\n                    />\r\n                </div>\r\n                {imagePreview && (\r\n                    <div>\r\n                        <p className=\"block\">Preview hình ảnh:</p>\r\n                        <img src={imagePreview} alt=\"Preview\" className=\"mt-2 max-w-xs\" />\r\n                    </div>\r\n                )}\r\n                <button\r\n                    type=\"submit\"\r\n                    className=\"focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800\"\r\n                    disabled={isLoading}\r\n                >\r\n                    {isLoading ? 'Đang tạo...' : 'Tạo sản phẩm'}\r\n                </button>\r\n                <Link href=\"/admin/products\" className=\"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800\">\r\n                Quay về trang product\r\n                </Link>\r\n            </form>\r\n            {success && <p className=\"text-green-500 mt-4\">{success}</p>}\r\n            {error && <p className=\"text-red-500 mt-4\">{error}</p>}\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}